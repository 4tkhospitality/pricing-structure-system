{
    "project_name": "Pricing Structure System",
    "repo_url": "https://github.com/4tkhospitality/pricing-structure-system",
    "tech_stack": {
        "frontend": "Next.js 16 (Turbopack), React 19, Tailwind CSS 4",
        "database": {
            "provider": "Supabase PostgreSQL",
            "orm": "Prisma 7.3.0",
            "adapter": "@prisma/adapter-pg"
        },
        "hosting": "Firebase Hosting (Static Export)",
        "deployment_id": "pricing-structure-system"
    },
    "database_schema": {
        "summary": "Lưu thông tin về RoomTypes (với basePrice), RatePlans, OTAChannels và Campaigns.",
        "tables": [
            "RoomType: Có thêm cột basePrice (Giá nhận về NET)",
            "RatePlan: Gói giá (mở rộng từ RoomType)",
            "OTAChannel: Cấu hình kênh và Commission",
            "CampaignInstance: Khuyến mãi linh hoạt"
        ],
        "relationships_explained": "Dữ liệu được lưu trữ trên Supabase Cloud, kết nối qua Prisma Client."
    },
    "api_endpoints": [
        {
            "path": "/api/room-types",
            "description": "Lấy và thêm hạng phòng (có basePrice)"
        },
        {
            "path": "/api/room-types/[id]",
            "description": "Sửa/Xóa hạng phòng (Sử dụng PATCH)"
        },
        {
            "path": "/api/ota-channels",
            "description": "Cấu hình kênh OTA"
        }
    ],
    "features": [
        {
            "name": "Bảng tính cấu trúc giá OTA",
            "status": "implemented",
            "description": "Tab-based UI with specific branding: Hạng phòng -> Từng kênh OTA -> Nhìn Tổng thể."
        },
        {
            "name": "Unified Bulk Calculator",
            "status": "implemented",
            "description": "Tính giá đồng bộ (Straight Line UI) với các chế độ thu về NET hoặc đồng đều giá bán."
        },
        {
            "name": "Manual Firebase Deployment",
            "status": "implemented",
            "description": "Xử lý lỗi project id bằng lệnh firebase deploy --project pricing-structure-system."
        },
        {
            "name": "Agoda UI Refinement & Localization",
            "status": "implemented",
            "description": "Vietnamese localized UI, reordered layout (Settings > Promotions), Step-by-step calculator with thousands separator, and updated default settings (20%, Additive)."
        }
    ],
    "knowledge_items": {
        "patterns": [
            "Grid-based layout cho Calculator",
            "PATCH method cho updates để tối ưu payload",
            "Escaping '->' in JSX labels using {'->'}",
            "Input number formatting using toLocaleString and regex replacement"
        ],
        "gotchas": [
            {
                "issue": "Next.js Static Build vs Dynamic APIs",
                "resolution": "Cấm để 'output: export' nếu muốn chạy Database trên localhost. Chỉ bật khi deploy hosting tĩnh."
            },
            {
                "issue": "Firebase Hosting limitations",
                "resolution": "Bản Hosting tĩnh không hỗ trợ lệnh ghi trực tiếp. Cần dùng localhost cho CMS/Admin tasks."
            },
            {
                "issue": "Firebase CLI Project ID",
                "resolution": "Nếu lỗi 'No active project', cần dùng flag --project pricing-structure-system."
            }
        ]
    }
}