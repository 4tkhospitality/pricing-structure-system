{
    "project_name": "Pricing Structure System",
    "repo_url": "https://github.com/Antigravity-Solutions/pricing-structure-system.git",
    "tech_stack": {
        "frontend": "Next.js 16 (Turbopack), React 19, Tailwind CSS 4",
        "database": {
            "provider": "Supabase PostgreSQL",
            "orm": "Prisma 7.3.0",
            "adapter": "@prisma/adapter-pg"
        },
        "hosting": "Firebase Standard Hosting (Static Export)"
    },
    "deployment": {
        "current_url": "https://pricing-structure-system.web.app/",
        "strategy": "Static Export (output: 'export')",
        "caveats": "Server-side dynamic features (API routes, server actions) are only available in local dev."
    },
    "database_schema": {
        "summary": "Lưu thông tin về RoomTypes, RatePlans, OTAChannels và Campaigns.",
        "tables": [
            "RoomType: Danh mục phòng (đã đồng bộ thành công)",
            "RatePlan: Gói giá (liên kết với RoomType)",
            "OTAChannel: Kênh OTA với commission & calcType",
            "CampaignInstance: Chương trình khuyến mãi"
        ],
        "relationships_explained": "1 RoomType -> nhiều RatePlans; 1 OTAChannel -> nhiều CampaignInstances."
    },
    "api_endpoints": [
        {
            "path": "/api/room-types",
            "description": "CRUD danh mục phòng (Đã fix 500 error)"
        },
        {
            "path": "/api/campaigns",
            "description": "CRUD chương trình khuyến mãi"
        },
        {
            "path": "/api/rate-plans",
            "description": "CRUD gói giá"
        },
        {
            "path": "/api/ota-channels",
            "description": "CRUD kênh OTA"
        }
    ],
    "features": [
        {
            "name": "Inverse Pricing Calculation",
            "status": "implemented",
            "description": "Tính toán giá bán bù đắp hoa hồng/KM (Net / (1-Comm) / (1-Disc))"
        },
        {
            "name": "Optimistic UI Room Management",
            "status": "implemented",
            "description": "Thêm phòng real-time ngay cả khi DB chậm, có nhãn 'Offline' nếu lỗi API"
        },
        {
            "name": "Live Calculator Preview",
            "status": "implemented",
            "description": "Công cụ kiểm tra giá 2 chiều (Net <-> Display) trong mỗi tab OTA"
        }
    ],
    "knowledge_items": {
        "patterns": [
            "Optimistic UI cho Room Management",
            "Inverse calculation logic cho pricing engine"
        ],
        "gotchas": [
            {
                "issue": "Prisma 7 url property",
                "resolution": "Move all url/directUrl to prisma.config.ts, schema.prisma must NOT contain them."
            },
            {
                "issue": "Supabase Pooling vs CLI",
                "resolution": "Always use DIRECT_URL (port 5432) for db push/migrate in Prisma 7."
            },
            {
                "issue": "Pricing Logic",
                "resolution": "Must use division for marking up prices, not addition, to accommodate cumulative discounts."
            }
        ]
    }
}